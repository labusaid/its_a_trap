<!DOCTYPE html>
<html>

<head>
    <title>Geolocation</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="itsatrap.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body>
    <div class="banner">
        <div class="button-stack">
            <button type="button" class="btn btn-secondary banner-button" onclick="toggleHeatmap()">Toggle Heatmap</button>
            <button type="button" class="btn btn-secondary banner-button" onclick="changeGradient()">Change gradient</button>
        </div>
        <img id="theImage" src="trappic.png" alt="image broke" class="center">
        <div class="button-stack">
            <button type="button" class="btn btn-secondary banner-button" onclick="changeRadius()">Change radius</button>
            <button type="button" class="btn btn-secondary banner-button" onclick="changeOpacity()">Change opacity</button>
        </div>
    </div>

    <div id="map" class="center"></div>
    <script src="itsatrap.js"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDf9Lci-_vFttF7QkL9-vsa0JY72QB5ZII&libraries=visualization&callback=initMap"></script>
	<script src="./papaparse.min.js"></script>
	<script src="./jquery-2.1.1.min.js"></script>
	<script>
	var data;
	//var dir = (loc.substring(0, loc.lastIndexOf('/'))).concat('/mapsDf.csv');
	//const file = fs.createReadStream(dir);
	function handleFileSelect(evt) {
		var file = evt.target.files[0];
		Papa.parse(file, {
			header: true,
			dynamicTyping: true,
			complete: function(results) {
				data = results;
			}
		});
	}
	$(document).ready(function(){
    $("#csv-file").change(handleFileSelect);
	});
/*	
	var count = 0; // cache the running count
papa.parse(file, {
    worker: true, // Don't bog down the main thread if its a big file
    step: function(result) {
        // do stuff with result
    },
    complete: function(results, file) {
        console.log('parsing complete read', count, 'records.'); 
    }
});
*/
</script>
<input type="file" id="csv-file" name="files"/>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDf9Lci-_vFttF7QkL9-vsa0JY72QB5ZII&libraries=visualization&callback=initMap">
    </script>
</body>

</html>